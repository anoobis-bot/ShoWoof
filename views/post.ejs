<!DOCTYPE html>
<html>
    <head>
        <title><%= data.title %></title>
        <link rel="stylesheet" type="text/css" href="/css/post_format.css"/>
        <link rel="stylesheet" type="text/css" href="/css/format.css"/>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="/js/comment.js"></script>
        <script src="/js/share.js"></script>
    </head>
    <body>
        <%- include('partials/sticky_header.ejs'); %>
    
        <%- include('partials/nav_panel.ejs'); %>

        <main>
            <div class="post">
                <div class="votes">
                   <div class="upvote"></div>
                   <div class="numberOfVotes"><%= data.votes %></div>
                   <div class="downvote"></div>
                </div>

                <div class="contentWhole">
                    <div class="postHead">
                        <div class="firstBar">
                            <div class="username">
                                Posted by <a href="/profiles/<%=data.author%>">u/<%= data.author %></a>
                            </div>
                            <div class="datePosted"> 
                                &nbsp;<%= data.datePosted.toDateString() %>
                            </div>
                        </div>
                        <div class="caption">
                            <%= data.title %>
                        </div>
                    </div>
                    <div class="content">
                        <% if (data.image_url != '') { %>
                            <!-- Show only image content -->
                            <img src="<%= data.image_url %>">
                        <% } else if (data.text_content != '') { %>
                            <!-- Show only text content -->
                            <p><%= data.text_content %></p>
                        <% } %>
                        
                    </div>
                    <div class="postToolBar">
                        <!-- <img src="/images/post_elements/comment.png">
                        <a href="#commentSection">Comments<a>&nbsp;
                        <img src="/images/post_elements/share.png">
                        <a>Share</a> -->
                        <img src="/images/post_elements/comment.png">
                        <a href="#commentSection">Comments</a>&nbsp;
                        <div id="copyLink">
                        <img src="/images/post_elements/share.png">
                        Share</div>
                        &nbsp;
                        <% if(data.author == user){ %>
                            <img src="/images/post_elements/output-onlinepngtools.png" class="action-icon">
                            &nbsp;
                            <a href="/editPost/<%=data._id%>">Edit</a>
                        <%  } %>

                    </div>
                    <br>
                    <div class="userComment">
                        <div class="commentLabel">
                            <div>Comment as</div>&nbsp;<div class="commentUsername">u/<%= user %></div>
                        </div>
                        <form action="/posts/<%=data._id%>" class="com__form"method="POST">
                            <textarea placeholder="Bark!" class="textarea" id="inputComment" name="comTerm"></textarea>
                            <div class="userCommentCommands">
                                <button type="submit" class="commentButton" id="postComment">Comment</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!------------------->
            <div class="comments" id="commentSection">
                <% data.Comments.forEach(comments => { %>
                    <div class="commentBase" id="comment-1">
                        <div class="commenterImg"></div>
                        <div class="commentDetails">
                            <div class="commenterDetails">
                                <div class="commenterUser"><%= comments.commentAuthor %></div>
                                <div class="commentDate"><%= comments.commentDate.toDateString() %></div>
                            </div>
                            <div class="commentText"><%= comments.comment %></div>
                            <div class="commentCommandBar">
                                <div class="commentVote">
                                    <div class="upvote"></div>
                                    &nbsp;
                                    <div class="commentToolText"><%= comments.commentUpvotes %></div>
                                    &nbsp;
                                    <div class="downvote"></div>
                                </div>
                                <div class="commentReply">
                                    <img src="/images/post_elements/comment.png">
                                    <div class="commentToolText">Reply</div>
                                </div>
                                <div class="commentEdit">
                                    <img src="/images/post_elements/output-onlinepngtools.png">
                                    <div class="commentToolText">Edit</div>
                                </div>
                            </div>
                        </div>
                    </div> 
               <% }); %>
            </div>
        </main>
    </body>
</html>